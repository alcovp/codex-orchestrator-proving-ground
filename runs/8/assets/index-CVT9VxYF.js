(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function l(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=l(o);fetch(o.href,i)}})();const r={columns:20,rows:20,tile:30,tickMs:140,background:"#0b0f16",grid:"rgba(255, 255, 255, 0.06)",snake:"#4ade80",snakeHead:"#22c55e",apple:"#f43f5e"},s=document.getElementById("game");if(!s)throw new Error('Не найден canvas с id="game"');const n=s.getContext("2d");if(!n)throw new Error("Canvas 2D контекст недоступен");s.width=r.columns*r.tile;s.height=r.rows*r.tile;let f={x:1,y:0},h={x:1,y:0},c=[],u={x:0,y:0};function g(){const e=Math.floor(r.columns/2),t=Math.floor(r.rows/2);f={x:1,y:0},h={x:1,y:0},c=[{x:e,y:t},{x:e-1,y:t},{x:e-2,y:t}],u=w()}function w(){const e=[];for(let l=0;l<r.rows;l+=1)for(let a=0;a<r.columns;a+=1){const o={x:a,y:l};x(o)||e.push(o)}if(e.length===0)return{...c[0]};const t=Math.floor(Math.random()*e.length);return e[t]}function x(e){return c.some(t=>t.x===e.x&&t.y===e.y)}function m(e){return e.x<0||e.y<0||e.x>=r.columns||e.y>=r.rows}function k(){n.fillStyle=r.background,n.fillRect(0,0,s.width,s.height),n.strokeStyle=r.grid,n.lineWidth=1;for(let e=0;e<=r.columns;e+=1){const t=e*r.tile+.5;n.beginPath(),n.moveTo(t,0),n.lineTo(t,s.height),n.stroke()}for(let e=0;e<=r.rows;e+=1){const t=e*r.tile+.5;n.beginPath(),n.moveTo(0,t),n.lineTo(s.width,t),n.stroke()}}function p(e,t){n.fillStyle=t,n.fillRect(e.x*r.tile+1,e.y*r.tile+1,r.tile-2,r.tile-2)}function y(){k(),c.forEach((e,t)=>{p(e,t===0?r.snakeHead:r.snake)}),p(u,r.apple)}function v(){f=h;const e=c[0],t={x:e.x+f.x,y:e.y+f.y};if(m(t)||x(t)){g(),y();return}const l=t.x===u.x&&t.y===u.y;c=[t,...c],l?u=w():c.pop(),y()}function b(e){e.x+f.x===0&&e.y+f.y===0||(h=e)}const O={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};window.addEventListener("keydown",e=>{const t=O[e.key];t&&(e.preventDefault(),b(t))});g();y();window.setInterval(v,r.tickMs);
